C51 COMPILER V9.60.7.0   TIMER0                                                            02/27/2026 18:03:14 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE TIMER0
OBJECT MODULE PLACED IN .\Release\Objects\timer0.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\..\User\timer0.c LARGE OPTIMIZE(9,SIZE) BROWSE INTVECTOR(0X000C) INCD
                    -IR(..\..\Libraries\Include;..\..\User) INTERVAL(3) DEBUG OBJECTEXTEND PRINT(.\Release\Listings\timer0.lst) OBJECT(.\Rele
                    -ase\Objects\timer0.obj)

line level    source

   1          #include "timer0.h"
   2          #include "user_config.h"
   3          #include "uart_data_handle.h"
   4          #include "adc.h"
   5          #include "ad_key.h"
   6          
   7          
   8          #define PEROID_VAL (SYSCLK / 128 / 1000 - 1) // Âë®ÊúüÂÄº=Á≥ªÁªüÊó∂Èíü/ÂàÜÈ¢ë/È¢ëÁéá - 1
   9          
  10          /**
  11           * @brief ÈÖçÁΩÆÂÆöÊó∂Âô®TMR0ÔºåÂÆöÊó∂Âô®ÈªòËÆ§ÂÖ≥Èó≠
  12           */
  13          void timer0_init(void)
  14          {
  15   1          __EnableIRQ(TMR0_IRQn); // ‰ΩøËÉΩtimer0‰∏≠Êñ≠
  16   1          IE_EA = 1;              // ‰ΩøËÉΩÊÄª‰∏≠Êñ≠ 
  17   1       
  18   1          TMR_ALLCON = TMR0_CNT_CLR(0x1);                        // Ê∏ÖÈô§ËÆ°Êï∞ÂÄº
  19   1          TMR0_PRH = TMR_PERIOD_VAL_H((PEROID_VAL >> 8) & 0xFF); // Âë®ÊúüÂÄº
  20   1          TMR0_PRL = TMR_PERIOD_VAL_L((PEROID_VAL >> 0) & 0xFF);
  21   1          TMR0_CONH = TMR_PRD_PND(0x1) | TMR_PRD_IRQ_EN(0x1);                          // ËÆ°Êï∞Á≠â‰∫éÂë®ÊúüÊó∂Â
             -ÖÅËÆ∏ÂèëÁîü‰∏≠Êñ≠
  22   1          TMR0_CONL = TMR_SOURCE_SEL(0x7) | TMR_PRESCALE_SEL(0x7) | TMR_MODE_SEL(0x1); // ÈÄâÊã©Á≥ªÁªüÊó∂ÈíüÔºå1
             -28ÂàÜÈ¢ëÔºåËÆ°Êï∞Ê®°Âºè
  23   1      }
  24          
  25          
  26          
  27          // extern void fun(void);
  28          // ÂÆöÊó∂Âô®TMR0‰∏≠Êñ≠ÊúçÂä°ÂáΩÊï∞
  29          void TIMR0_IRQHandler(void) interrupt TMR0_IRQn
  30          {
  31   1          // ËøõÂÖ•‰∏≠Êñ≠ËÆæÁΩÆIPÔºå‰∏çÂèØÂà†Èô§
  32   1          __IRQnIPnPush(TMR0_IRQn);
  33   1      
  34   1          // ---------------- Áî®Êà∑ÂáΩÊï∞Â§ÑÁêÜ -------------------
  35   1      
  36   1          // Âë®Êúü‰∏≠Êñ≠
  37   1          if (TMR0_CONH & TMR_PRD_PND(0x1))
  38   1          {
  39   2              TMR0_CONH |= TMR_PRD_PND(0x1); // Ê∏ÖÈô§pending
  40   2      
  41   2              ad_key_para.cur_scan_times++;
  42   2      
  43   2              {
  44   3                  static u8 cnt = 0;
  45   3                  cnt ++;
  46   3                  if (cnt >= 2)
  47   3                  {
  48   4                      cnt = 0;
  49   4                      adc_scan();
  50   4                  }            
  51   3              }
C51 COMPILER V9.60.7.0   TIMER0                                                            02/27/2026 18:03:14 PAGE 2   

  52   2              
  53   2      
  54   2      
  55   2              uart_receiver_timeout_add(); 
  56   2      
  57   2              debug_time_add();
  58   2      
  59   2      
  60   2      
  61   2      
  62   2      
  63   2      
  64   2          }
  65   1      
  66   1          // ÈÄÄÂá∫‰∏≠Êñ≠ËÆæÁΩÆIPÔºå‰∏çÂèØÂà†Èô§
  67   1          __IRQnIPnPop(TMR0_IRQn);
  68   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    122    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      1    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
